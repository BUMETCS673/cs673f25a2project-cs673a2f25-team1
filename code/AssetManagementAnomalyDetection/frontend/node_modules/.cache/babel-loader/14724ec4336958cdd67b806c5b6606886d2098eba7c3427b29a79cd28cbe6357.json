{"ast":null,"code":"import React,{useState,useEffect}from'react';import{ThemeProvider,createTheme}from'@mui/material/styles';import{Container,Typography,Box,Paper,Grid,Button,Tabs,Tab}from'@mui/material';import{Line}from'react-chartjs-2';import axios from'axios';// import PDFUploadTest from './components/PDFUploadTest';\nimport PDFUploadTestSimple from'./PDFUploadTestSimple';import{Chart as ChartJS,CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend}from'chart.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend);const theme=createTheme();function App(){const[portfolios,setPortfolios]=useState([]);const[selectedPortfolio,setSelectedPortfolio]=useState(null);const[anomalies,setAnomalies]=useState([]);const[loading,setLoading]=useState(false);const[currentTab,setCurrentTab]=useState(0);useEffect(()=>{fetchPortfolios();},[]);const fetchPortfolios=async()=>{try{const response=await axios.get('/api/portfolios');setPortfolios(response.data);}catch(error){console.error('Error fetching portfolios:',error);}};const fetchAnomalies=async portfolioId=>{try{const response=await axios.get(\"/api/anomalies/\".concat(portfolioId));setAnomalies(response.data);}catch(error){console.error('Error fetching anomalies:',error);}};const runAnomalyDetection=async portfolioId=>{setLoading(true);try{await axios.post(\"/api/detect-anomalies/\".concat(portfolioId));await fetchAnomalies(portfolioId);}catch(error){console.error('Error running anomaly detection:',error);}finally{setLoading(false);}};const handlePortfolioSelect=portfolio=>{setSelectedPortfolio(portfolio);fetchAnomalies(portfolio.id);};const chartData={labels:anomalies.map(a=>new Date(a.detected_at).toLocaleDateString()),datasets:[{label:'Anomaly Score',data:anomalies.map(a=>a.anomaly_score),borderColor:'rgb(255, 99, 132)',backgroundColor:'rgba(255, 99, 132, 0.5)'}]};return/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsx(Container,{maxWidth:\"lg\",children:/*#__PURE__*/_jsxs(Box,{sx:{my:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:\"Asset Management Anomaly Detection\"}),/*#__PURE__*/_jsx(Paper,{sx:{mb:3},children:/*#__PURE__*/_jsxs(Tabs,{value:currentTab,onChange:(e,newValue)=>setCurrentTab(newValue),children:[/*#__PURE__*/_jsx(Tab,{label:\"Anomaly Detection\"}),/*#__PURE__*/_jsx(Tab,{label:\"PDF Upload Test\"})]})}),currentTab===0?/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsxs(Paper,{sx:{p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Portfolios\"}),portfolios.map(portfolio=>/*#__PURE__*/_jsx(Box,{sx:{mb:1},children:/*#__PURE__*/_jsx(Button,{variant:(selectedPortfolio===null||selectedPortfolio===void 0?void 0:selectedPortfolio.id)===portfolio.id?\"contained\":\"outlined\",fullWidth:true,onClick:()=>handlePortfolioSelect(portfolio),children:portfolio.name})},portfolio.id))]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:8,children:selectedPortfolio&&/*#__PURE__*/_jsxs(Paper,{sx:{p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:selectedPortfolio.name}),/*#__PURE__*/_jsxs(Typography,{children:[\"Manager: \",selectedPortfolio.manager]}),/*#__PURE__*/_jsxs(Typography,{children:[\"Total Assets: $\",selectedPortfolio.total_assets.toLocaleString()]}),/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>runAnomalyDetection(selectedPortfolio.id),disabled:loading,children:loading?'Detecting...':'Run Anomaly Detection'})}),anomalies.length>0&&/*#__PURE__*/_jsxs(Box,{sx:{mt:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[\"Detected Anomalies (\",anomalies.length,\")\"]}),/*#__PURE__*/_jsx(Box,{sx:{height:300},children:/*#__PURE__*/_jsx(Line,{data:chartData})})]})]})})]}):/*#__PURE__*/_jsx(PDFUploadTestSimple,{})]})})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","ThemeProvider","createTheme","Container","Typography","Box","Paper","Grid","Button","Tabs","Tab","Line","axios","PDFUploadTestSimple","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","jsx","_jsx","jsxs","_jsxs","register","theme","App","portfolios","setPortfolios","selectedPortfolio","setSelectedPortfolio","anomalies","setAnomalies","loading","setLoading","currentTab","setCurrentTab","fetchPortfolios","response","get","data","error","console","fetchAnomalies","portfolioId","concat","runAnomalyDetection","post","handlePortfolioSelect","portfolio","id","chartData","labels","map","a","Date","detected_at","toLocaleDateString","datasets","label","anomaly_score","borderColor","backgroundColor","children","maxWidth","sx","my","variant","component","gutterBottom","mb","value","onChange","e","newValue","container","spacing","item","xs","md","p","fullWidth","onClick","name","manager","total_assets","toLocaleString","mt","disabled","length","height"],"sources":["/Users/tsuimingleong/Documents/GitHub/cs673f25a2project-cs673a2f25-team1/code/AssetManagementAnomalyDetection/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { ThemeProvider, createTheme } from '@mui/material/styles';\nimport { Container, Typography, Box, Paper, Grid, Button, Tabs, Tab } from '@mui/material';\nimport { Line } from 'react-chartjs-2';\nimport axios from 'axios';\n// import PDFUploadTest from './components/PDFUploadTest';\nimport PDFUploadTestSimple from './PDFUploadTestSimple';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend,\n} from 'chart.js';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend\n);\n\nconst theme = createTheme();\n\ninterface Portfolio {\n  id: number;\n  name: string;\n  manager: string;\n  total_assets: number;\n}\n\ninterface Anomaly {\n  id: number;\n  fee_id: number;\n  anomaly_score: number;\n  detected_at: string;\n}\n\nfunction App() {\n  const [portfolios, setPortfolios] = useState<Portfolio[]>([]);\n  const [selectedPortfolio, setSelectedPortfolio] = useState<Portfolio | null>(null);\n  const [anomalies, setAnomalies] = useState<Anomaly[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [currentTab, setCurrentTab] = useState(0);\n\n  useEffect(() => {\n    fetchPortfolios();\n  }, []);\n\n  const fetchPortfolios = async () => {\n    try {\n      const response = await axios.get('/api/portfolios');\n      setPortfolios(response.data);\n    } catch (error) {\n      console.error('Error fetching portfolios:', error);\n    }\n  };\n\n  const fetchAnomalies = async (portfolioId: number) => {\n    try {\n      const response = await axios.get(`/api/anomalies/${portfolioId}`);\n      setAnomalies(response.data);\n    } catch (error) {\n      console.error('Error fetching anomalies:', error);\n    }\n  };\n\n  const runAnomalyDetection = async (portfolioId: number) => {\n    setLoading(true);\n    try {\n      await axios.post(`/api/detect-anomalies/${portfolioId}`);\n      await fetchAnomalies(portfolioId);\n    } catch (error) {\n      console.error('Error running anomaly detection:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePortfolioSelect = (portfolio: Portfolio) => {\n    setSelectedPortfolio(portfolio);\n    fetchAnomalies(portfolio.id);\n  };\n\n  const chartData = {\n    labels: anomalies.map(a => new Date(a.detected_at).toLocaleDateString()),\n    datasets: [\n      {\n        label: 'Anomaly Score',\n        data: anomalies.map(a => a.anomaly_score),\n        borderColor: 'rgb(255, 99, 132)',\n        backgroundColor: 'rgba(255, 99, 132, 0.5)',\n      },\n    ],\n  };\n\n  return (\n    <ThemeProvider theme={theme}>\n      <Container maxWidth=\"lg\">\n        <Box sx={{ my: 4 }}>\n          <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n            Asset Management Anomaly Detection\n          </Typography>\n\n          <Paper sx={{ mb: 3 }}>\n            <Tabs value={currentTab} onChange={(e, newValue) => setCurrentTab(newValue)}>\n              <Tab label=\"Anomaly Detection\" />\n              <Tab label=\"PDF Upload Test\" />\n            </Tabs>\n          </Paper>\n\n          {currentTab === 0 ? (\n            <Grid container spacing={3}>\n            <Grid item xs={12} md={4}>\n              <Paper sx={{ p: 2 }}>\n                <Typography variant=\"h6\" gutterBottom>\n                  Portfolios\n                </Typography>\n                {portfolios.map((portfolio) => (\n                  <Box key={portfolio.id} sx={{ mb: 1 }}>\n                    <Button\n                      variant={selectedPortfolio?.id === portfolio.id ? \"contained\" : \"outlined\"}\n                      fullWidth\n                      onClick={() => handlePortfolioSelect(portfolio)}\n                    >\n                      {portfolio.name}\n                    </Button>\n                  </Box>\n                ))}\n              </Paper>\n            </Grid>\n\n            <Grid item xs={12} md={8}>\n              {selectedPortfolio && (\n                <Paper sx={{ p: 2 }}>\n                  <Typography variant=\"h6\" gutterBottom>\n                    {selectedPortfolio.name}\n                  </Typography>\n                  <Typography>Manager: {selectedPortfolio.manager}</Typography>\n                  <Typography>Total Assets: ${selectedPortfolio.total_assets.toLocaleString()}</Typography>\n\n                  <Box sx={{ mt: 2 }}>\n                    <Button\n                      variant=\"contained\"\n                      onClick={() => runAnomalyDetection(selectedPortfolio.id)}\n                      disabled={loading}\n                    >\n                      {loading ? 'Detecting...' : 'Run Anomaly Detection'}\n                    </Button>\n                  </Box>\n\n                  {anomalies.length > 0 && (\n                    <Box sx={{ mt: 3 }}>\n                      <Typography variant=\"h6\" gutterBottom>\n                        Detected Anomalies ({anomalies.length})\n                      </Typography>\n                      <Box sx={{ height: 300 }}>\n                        <Line data={chartData} />\n                      </Box>\n                    </Box>\n                  )}\n                </Paper>\n              )}\n            </Grid>\n          </Grid>\n          ) : (\n            <PDFUploadTestSimple />\n          )}\n        </Box>\n      </Container>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}